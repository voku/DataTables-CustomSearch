/*
 * DataTables-CustomSearch by ruhley (2015-11-30, 11:06)
 */

!function(window,document,undefined){"use strict";var factory=function($,DataTable){var CustomSearch=function(table,config){var that=this;if(!(this instanceof CustomSearch))throw'Warning: CustomSearch must be initialised with the keyword "new".';if(!$.fn.dataTableExt.fnVersionCheck("1.10.0"))throw"Warning: CustomSearch requires DataTables 1.10 or greater.";return this.c={global:{},fields:[],container:"",hideStandardSearch:!0},this.s={dt:null,init:null,table:null},$(table).on("init.dt-custom-search",function(){that.init(table,config)}),this};return CustomSearch.prototype={init:function(table,config){var i,j,k,id,field,type,element,currentColumn,sequentialCount,method,row,that=this,form=[];if(this.s.dt=new DataTable.Api(table).settings()[0],this.s.init=config||{},this.s.table=$(this.s.dt.nTable),$.extend(!0,this.c,CustomSearch.defaults,config),this.c.hideStandardSearch===!0&&$("#"+this.s.dt.sInstance+"_filter").hide(),null===this.c.fields||this.c.fields===undefined||0===this.c.fields.length)for(this.c.fields=[],i=0;i<this.s.dt.aoColumns.length;i++)this.c.fields.push(i);for($.isArray(this.c.fields)||(this.c.fields=[this.c.fields]),i=0;i<this.c.fields.length;i++)field=this.c.fields[i],(!isNaN(field)||$.isArray(field))&&(field={columns:field}),field=$.extend(!0,{},this.c.global,field),field.columns=$.isArray(field.columns)?field.columns:[field.columns],field.columns.sort(),field.multiple=this.getMultiple(field.multiple),field.type=this.getType(field.type,field.columns),field.dataType=this.getDataType(field.columns),field.range=this.getRange(field.range),field.dateFormat=this.getDateFormat(field.dateFormat),field.slider=field.slider===!0&&this.hasRange("min",field.range)&&this.hasRange("max",field.range),field.label=this.getLabel(field.label,field.range,field.columns,field.slider),field.id=this.getId(i,field.range,field.field,field.slider),field.advanced=this.getAdvanced(field.advanced,field.range,field.id,field.type),field.server=this.getServer(field.server,field.id),field.caseInsensitive=field.caseInsensitive!==!1,field.smart=field.smart===!0,field.autocomplete=field.autocomplete===!0,field.chosen=field.chosen===!0,field.trigger="key"===field.trigger?"keyup":"change",field=this.getField(field),this.c.fields[i]=field,form.push(field.fullField);if(this.c.fields.sort(this.sortBySubArray),"thead"===this.c.container||"tfoot"===this.c.container){if(type=this.c.container.indexOf("thead")>=0?"thead":"tfoot",element=this.s.table.find(type),row=element.find("tr"),0===element.length)for(this.s.table.append("<"+type+">"),element=this.s.table.find(type),row=$("<tr>").appendTo(element),i=0;i<this.s.dt.aoColumns.length;i++)row.append($("<th>").toggle(this.s.dt.aoColumns[i].bVisible));for(i=0;i<this.c.fields.length;i++)row.find("th").eq(this.c.fields[i].columns[0]).append(this.c.fields[i].field)}else if("thead:before"===this.c.container||"thead:after"===this.c.container||"tfoot:before"===this.c.container||"tfoot:after"===this.c.container)for(type=this.c.container.indexOf("thead")>=0?"thead":"tfoot",element=this.s.table.find(type),currentColumn=0,sequentialCount=1,method="prependTo",this.c.container===type+":after"&&(method="appendTo"),0===element.length&&this.s.table.append("<"+type+">"),element=this.s.table.find(type),row=$("<tr>")[method](element),i=0;i<this.c.fields.length;i++)for(j=0;j<this.c.fields[i].columns.length;j++){for(;this.c.fields[i].columns[j]>currentColumn;)row.append($("<td>")),currentColumn++;if(1===this.c.fields[i].columns.length)row.append($("<td>").append(this.c.fields[i].field));else{for(sequentialCount=1,k=j+1;k<this.c.fields[i].columns.length&&this.c.fields[i].columns[k]===this.c.fields[i].columns[j]+1;k++)sequentialCount++,currentColumn++;row.append($("<td>").attr("colspan",sequentialCount).append($(this.c.fields[i].field))),j=k}currentColumn++}else this.c.container?$(this.c.container).append("<div>"+form.join("")+"</div>"):$(this.s.dt.nTableWrapper).prepend("<div>"+form.join("")+"</div>");for(i=0;i<this.c.fields.length;i++)field=this.c.fields[i],field.autocomplete?$("#"+field.id).autocomplete({source:that.getDistinctValuesInColumn(field.columns,field.dataType,!0),select:function(evt,ui){$(this).val(ui.item.label),that.triggerSearch()}})[field.trigger](function(){that.triggerSearch()}):field.slider?(j=this.getDistinctValuesInColumn(field.columns,field.dataType,!0),$("#"+field.id).slider({min:that.intParse(j[0]),max:that.intParse(j[j.length-1]),values:[that.intParse(j[0]),that.intParse(j[j.length-1])],range:!0,slide:function(evt,ui){$("#"+this.id+"_display").text(ui.values[0]+" - "+ui.values[1]),that.triggerSearch()}}),$("#"+field.id+"_display").text(j[0]+" - "+j[j.length-1])):(id=[],0===field.range.length?id.push(field.id):(field.id.min&&id.push(field.id.min),field.id.max&&id.push(field.id.max)),$("#"+id.join(",#"))[field.trigger](function(){that.triggerSearch()}),field.chosen&&$("#"+id.join(",#")).chosen({allow_single_deselect:!0,width:"100%"}),"switch"===field.type&&$("#"+field.id).buttonset());this.s.dt.oInit.serverSide||this.s.table.dataTable().DataTable.ext.search.push(function(settings,data,dataIndex){return settings.nTable.id===that.s.dt.nTable.id?that.search(settings,data,dataIndex):!0}),$.isFunction(this.c.after)&&this.s.table.on("search.dt",function(evt,settings){var i,rows=settings.aiDisplay,data=that.s.table.DataTable().data(),pagePassedData=[],allPassedData=[],to=settings._iDisplayStart+settings._iDisplayLength;for(to>data.length&&(to=data.length),to>rows.length&&(to=rows.length),i=settings._iDisplayStart;to>i;i++)pagePassedData.push(data[rows[i]]);for(i=0;i<rows.length;i++)allPassedData.push(data[rows[i]]);that.c.after(pagePassedData,allPassedData,data)})},search:function(settings,data,dataIndex){var i,j,pass,value,values,field,allFields,advancedValue;for(i=0;i<this.c.fields.length;i++)if(field=this.c.fields[i],advancedValue=field.advanced?$("#"+field.advanced.id).val():!1,0===field.range.length){if("switch"===field.type?(value=[],$("#"+field.id+" input:checked").each(function(){value.push($(this).val())})):value=$("#"+field.id).val(),value||(value=""),value.length){if(pass=!1,"date"!==field.type||advancedValue){for(allFields=[],j=0;j<field.columns.length;j++)allFields.push(data[field.columns[j]]);this.searchString(allFields.join(" "),value,advancedValue,field.caseInsensitive,field.smart)&&(pass=!0)}else for(j=0;j<field.columns.length;j++)if(this.searchDate(data[field.columns[j]],value,field.dateFormat)){pass=!0;break}if(pass===!1)return!1}}else if(values=field.slider?{min:$("#"+field.id).slider("values",0),max:$("#"+field.id).slider("values",1)}:{min:this.hasRange("min",field.range)?$("#"+field.id.min).val():"",max:this.hasRange("max",field.range)?$("#"+field.id.max).val():""},values.min||(values.min=""),values.max||(values.max=""),values.min||values.max){for(pass=!1,j=0;j<field.columns.length;j++)if("date"===field.type){if(this.searchDateRange(data[field.columns[j]],values,field.dateFormat)){pass=!0;break}}else if(this.searchNumberRange(data[field.columns[j]],values)){pass=!0;break}if(pass===!1)return!1}return!0},searchString:function(cell,value,advanced,caseInsensitive,smart){var pass=!1;return pass=null!==value&&value.length?this.searchStringAdvanced(cell,value,advanced,caseInsensitive,smart):!0},searchStringAdvanced:function(string,search,advanced,caseInsensitive,smart){var i,stringNumber,searchNumber;for(caseInsensitive&&(string=string.toLowerCase()),stringNumber=this.intParse(string),$.isArray(search)||(search=[search]),i=0;i<search.length;i++){if(caseInsensitive&&(search[i]=search[i].toLowerCase()),searchNumber=this.intParse(search[i]),!(advanced&&"contains"!==advanced||-1===string.search(search[i])))return!0;if("not-contains"===advanced&&-1===string.search(search[i]))return!0;if("equal"===advanced&&string===search[i])return!0;if("not-equal"===advanced&&string!==search[i])return!0;if("greater"===advanced&&stringNumber>searchNumber)return!0;if("less"===advanced&&searchNumber>stringNumber)return!0;if("begins"===advanced&&0===string.indexOf(search[i]))return!0}return!1},searchNumberRange:function(cell,values){return cell=this.intParse(cell),values.min=this.intParse(values.min),values.max=this.intParse(values.max),isNaN(cell)?!1:isNaN(values.min)&&isNaN(values.max)||isNaN(values.min)&&values.max>=cell||values.min<=cell&&isNaN(values.max)||values.min<=cell&&values.max>=cell},searchDate:function(cell,value,dateFormat){return cell=moment(cell,dateFormat.cell),value=moment(cell,dateFormat.input),cell.isValid()===!1&&value.isValid()===!1?!1:cell.isSame(value)},searchDateRange:function(cell,values,dateFormat){return cell=moment(cell,dateFormat.cell),cell.isValid()===!1?!1:""!=values.min&&""!=values.max&&(values.min=moment(values.min,dateFormat.cell),values.max=moment(values.max,dateFormat.cell),values.min.isValid()===!0&&values.max.isValid()===!0)?!values.min.isAfter(values.max)&&(cell.isBetween(cell.isAfter(values.min),values.max)||cell.isSame(values.min)||cell.isBetween(values.min,values.max)||cell.isSame(values.max)):""!=values.min&&(values.min=moment(values.min,dateFormat.cell),values.min.isValid()===!0)?cell.isAfter(values.min)||cell.isSame(values.min):""!=values.max&&(values.max=moment(values.max,dateFormat.cell),values.max.isValid()===!0)?cell.isBefore(values.max)||cell.isSame(values.max):void 0},getRange:function(range){var newRange=[],isMin=!1,isMax=!1;return"string"==typeof range&&(newRange=range.split(",")),$.isArray(range)&&(isMin=this.hasRange("min",range),isMax=this.hasRange("max",range),newRange=isMin&&isMax?["min","max"]:isMin&&!isMax?["min"]:!isMin&&isMax?["max"]:[]),range===undefined&&(newRange=[]),range===!0&&(newRange=["min","max"]),newRange},getDateFormat:function(dateFormat){var newDateFormat={cell:"YYYY-MM-DD",input:"YYYY-MM-DD"};return null!==dateFormat&&"undefined"!=typeof dateFormat&&"object"==typeof dateFormat&&(dateFormat.hasOwnProperty("cell")===!0&&(newDateFormat.cell=dateFormat.cell),dateFormat.hasOwnProperty("input")===!0&&(newDateFormat.input=dateFormat.input)),newDateFormat},getField:function(field){var newField=$(field.field);return field.field&&0!==newField.length||(newField=this.createField(field)),newField},createField:function(field){var i;switch(field.fieldLabel=[],field.field=[],field.type){case"string":case"html":field.label&&(field.fieldLabel='<label for="'+field.id+'">'+field.label+"</label>"),field.field=field.advanced.field+'<input type="text" id="'+field.id+'">';break;case"number":case"date":0===field.range.length?(field.label&&(field.fieldLabel='<label for="'+field.id+'">'+field.label+"</label>"),field.field=field.advanced.field+'<input type="'+field.type+'" id="'+field.id+'">'):field.slider?(field.fieldLabel='<label for="'+field.id+'">'+field.label+"</label>",field.field=field.advanced.field+'<div id="'+field.id+'"></div><div id="'+field.id+'_display"></div>'):(this.hasRange("min",field.range)&&(field.label&&field.fieldLabel.push('<label for="'+field.id.min+'">'+field.label.min+"</label>"),field.field.push('<input type="'+field.type+'" id="'+field.id.min+'">')),this.hasRange("max",field.range)&&(field.label&&field.fieldLabel.push('<label for="'+field.id.max+'">'+field.label.max+"</label>"),field.field.push('<input type="'+field.type+'" id="'+field.id.max+'">')));break;case"select":for(field.label&&(field.fieldLabel='<label for="'+field.id+'">'+field.label+"</label>"),$.isArray(field.options)&&0!==field.options.length||(field.options=this.getDistinctValuesInColumn(field.columns,field.dataType,!0)),field.field=field.advanced.field+'<select id="'+field.id+'"',field.multiple&&(field.field+=' multiple="multiple"'),field.field+=">",field.multiple||field.options.unshift({value:"",text:field.chosen?"":"All"}),i=0;i<field.options.length;i++)"object"==typeof field.options[i]?field.field+='<option value="'+field.options[i].value+'">'+field.options[i].text+"</option>":field.field+='<option value="'+field.options[i]+'">'+field.options[i]+"</option>";field.field+="</select>";break;case"switch":for($.isArray(field.options)&&0!==field.options.length||(field.options=this.getDistinctValuesInColumn(field.columns,field.dataType,!0)),i=0;i<field.options.length;i++)"object"==typeof field.options[i]?(field.field.push('<input type="checkbox" id="'+field.id+"_"+i+'" name="'+field.id+'"'+field.options[i].value+">"),field.field.push('<label for="'+field.id+"_"+i+'">'+field.options[i].text+"</label>")):(field.field.push('<input type="checkbox" id="'+field.id+"_"+i+'" name="'+field.id+'" value="'+field.options[i]+'">'),field.field.push('<label for="'+field.id+"_"+i+'">'+field.options[i]+"</label>"));field.field.unshift('<div id="'+field.id+'">'),field.field.push("</div>"),field.field=field.field.join("");break;default:throw"Warning: CustomSearch init failed due to invalid field type given - "+field.type}if(field.fullField="",$.isArray(field.field))for(i=0;i<field.field.length;i++)field.fullField+=field.fieldLabel[i],field.fullField+=field.field[i];else field.fullField+=field.fieldLabel,field.fullField+=field.field;return field},getDistinctValuesInColumn:function(columns,dataType,sort){var options=[],that=this;return $.each(this.s.dt.aoData,function(index,row){var i,data=[];if($.isArray(columns))for(i=0;i<columns.length;i++)data.push(row._aData[columns[i]]);else data.push(row._aData[columns]);data=data.join(" "),-1===$.inArray(data,options)&&options.push(data)}),sort&&("string"===dataType||"date"===dataType?options.sort():options.sort(function(a,b){return that.intParse(a)-that.intParse(b)})),options},getMultiple:function(multiple){return multiple===!0},intParse:function(number){return parseInt(number.toString().replace(/[^\d]/i,""),10)},getId:function(index,range,field,slider){var newId,fieldId,baseId=this.s.dt.sInstance+"_"+index;return 0===range.length||slider?newId=baseId:(newId={},this.hasRange("min",range)&&(newId.min=baseId+"_min"),this.hasRange("max",range)&&(newId.max=baseId+"_max")),$(field).length>0&&(fieldId=$(field).attr("id"),fieldId?newId=fieldId:$(field).attr("id",newId)),newId},getAdvanced:function(advanced,range,id,type){var i,advancedField="",advancedId=id+"_advanced",numerical="number"===type||"date"===type,options=[["contains","Contains",!numerical],["not-contains","Does Not Contain",!1],["equal","Is Equal To",numerical],["not-equal","Is Not Equal To",!1]];if(numerical?(options.push(["greater","Is Greather Than",!1]),options.push(["less","Is Less Than",!1])):options.push(["begins","Begins With",!1]),advanced===!0&&0===range.length){for(advancedField+='<select id="'+advancedId+'">',i=0;i<options.length;i++)advancedField+='<option value="'+options[i][0]+'"',options[i][2]&&(advancedField+=' selected="selected"'),advancedField+=">"+options[i][1]+"</option>";return advancedField+="</select>",{id:advancedId,field:advancedField}}return{id:"",field:""}},getServer:function(server,id){return server||id},getLabel:function(label,range,columns,slider){var j,newLabel="";if(label===undefined){for(label=[],j=0;j<columns.length;j++)label.push(this.s.dt.aoColumns[columns[j]].sTitle);label=label.join(" & ")}return 0===range.length||slider?newLabel=label:(newLabel={},this.hasRange("min",range)&&(label.hasOwnProperty("min")===!1?newLabel.min="Min "+label:newLabel.min=label.min),this.hasRange("max",range)&&(label.hasOwnProperty("max")===!1?newLabel.max="Max "+label:newLabel.max=label.max)),newLabel},getType:function(type,columns){var newType=type;return newType||(1===columns.length?(newType=this.s.dt.aoColumns[columns[0]].sType,("num"===newType||"currency"===newType||"num-fmt"===newType)&&(newType="number")):newType="string"),newType.toLowerCase()},getDataType:function(columns){var newDataType="string";return 1===columns.length&&(newDataType=this.s.dt.aoColumns[columns[0]].sType,("num"===newDataType||"currency"===newDataType||"num-fmt"===newDataType)&&(newDataType="number")),null===newDataType&&(newDataType="string"),newDataType.toLowerCase()},hasRange:function(value,range){return $.inArray(value,range)>=0},sortBySubArray:function(a,b){var minA=a.columns,minB=b.columns;return $.isArray(minA)&&(minA=Math.min.apply(Math,minA)),$.isArray(minB)&&(minB=Math.min.apply(Math,minB)),minA-minB},triggerSearch:function(){var ajax,j;if(this.s.dt.oInit.serverSide){for(ajax=this.s.dt.ajax,"string"==typeof ajax&&(ajax={url:ajax,data:{}}),ajax.data.customsearch={},j=0;j<this.c.fields.length;j++)ajax.data.customsearch[this.c.fields[j].server]=$("#"+this.c.fields[j].id).val();this.s.dt.ajax=ajax}this.s.table.DataTable().draw()}},DataTable.CustomSearch=CustomSearch,CustomSearch};"function"==typeof define&&define.amd?define("datatables-customsearch",["jquery","datatables"],factory):jQuery&&!jQuery.fn.dataTable.CustomSearch&&factory(jQuery,jQuery.fn.dataTable),jQuery.fn.customSearch=function(options_arg){return $(this.selector).each(function(){new jQuery.fn.dataTable.CustomSearch(this,options_arg)}),this}}(window,document);
//# sourceMappingURL=jquery.datatables.customsearch.min.js.map